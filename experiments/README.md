# Video Generation Experiments

這個資料夾包含系統性測試影片生成模組的實驗腳本。

## 實驗腳本

### `test_video_generation.py`

全面測試影片生成模組的性能和品質。

**測試參數：**
- **時長（Duration）**: 5秒、10秒
- **FPS**: 16
- **提示詞數量**: 3個（每個包含物體、場景、動作）

**總測試數量**: 2 durations × 3 prompts = **6 tests**

## 測試設計理念

每個提示詞都包含 **三個核心元素**：

1. **物體 (Object)**: 主要視覺焦點（如跑車、小鳥、太空人）
2. **場景 (Scene)**: 環境背景（如城市街道、森林、太空站）
3. **動作 (Action)**: 動態行為（如行駛、飛翔、漂浮）

## 測試提示詞

### Prompt 1: 紅色跑車在城市街道上高速行駛
- **物體**: 流線型紅色跑車
- **場景**: 霓虹燈照亮的城市街道（夜晚、濕地面）
- **動作**: 高速行駛、加速、過彎漂移

### Prompt 2: 藍色小鳥在森林中飛翔
- **物體**: 鮮豔的藍色小鳥
- **場景**: 晨霧繚繞的森林（陽光穿透樹木）
- **動作**: 優雅飛翔、在樹枝間穿梭

### Prompt 3: 太空人在太空站外漂浮
- **物體**: 白色太空服的太空人
- **場景**: 未來感太空站（地球背景）
- **動作**: 緩慢漂浮、旋轉、進行維修作業

## 使用方法

### 運行完整實驗

```bash
cd /root/audio2vedio
python experiments/test_video_generation.py
```

### 輸出結果

實驗結果會保存在 `experiments/results/exp_YYYYMMDD_HHMMSS/`:

```
exp_20250101_120000/
├── videos/                              # 生成的影片檔案
│   ├── d5_p1_car_city_driving.mp4      # 5秒 - 跑車
│   ├── d5_p2_bird_forest_flying.mp4    # 5秒 - 小鳥
│   ├── d5_p3_astronaut_space_floating.mp4  # 5秒 - 太空人
│   ├── d10_p1_car_city_driving.mp4     # 10秒 - 跑車
│   ├── d10_p2_bird_forest_flying.mp4   # 10秒 - 小鳥
│   └── d10_p3_astronaut_space_floating.mp4 # 10秒 - 太空人
├── logs/                                # 每個測試的詳細日誌
│   ├── d5_p1_car_city_driving.json
│   ├── d5_p2_bird_forest_flying.json
│   └── ...
├── full_results.json                    # 所有測試的完整結果
└── REPORT.md                            # 總結報告（markdown 格式）
```

## 報告內容

生成的 `REPORT.md` 包含：

1. **總體統計**
   - 總測試數
   - 成功/失敗數
   - 成功率

2. **按時長分析**
   - 每個時長的平均生成時間
   - 每秒影片的平均生成時間

3. **按提示詞分析**
   - 每個提示詞的性能表現
   - 不同內容類型的生成難易度

4. **詳細結果表格**
   - 每個測試的生成時間
   - GPU 記憶體使用量（Peak）
   - 狀態（成功/失敗）

5. **完整提示詞內容**
   - 每個測試的完整提示詞
   - 物體、場景、動作的分解說明

## 性能優化建議

根據實驗結果，可以調整以下參數：

- **縮短時長**: 如果 10 秒影片生成時間過長，考慮使用 5 秒
- **降低 FPS**: 如果需要更快的生成速度，可以降低到 8 或 12 FPS
- **啟用量化**: 在腳本中設定 `use_quantization=True` 以節省 GPU 記憶體

## 自訂測試

要新增自己的測試提示詞，編輯 `test_video_generation.py` 中的 `TEST_PROMPTS` 列表：

```python
TEST_PROMPTS = [
    {
        "id": "p4_custom_test",  # 唯一識別碼
        "description": "您的描述",  # 中文描述
        "prompt": "完整的英文提示詞，包含物體 + 場景 + 動作"
    },
    # 新增更多提示詞...
]
```

**提示詞撰寫建議：**
- 明確指定**主要物體**（如車輛、動物、人物）
- 描述**環境場景**（時間、地點、氛圍）
- 定義**動作行為**（移動、互動、變化）

要調整測試時長，修改 `DURATIONS` 列表：

```python
DURATIONS = [3, 5, 10]  # 測試 3秒、5秒、10秒
```

## 注意事項

- 完整實驗（6個測試）預計需要 **15-30 分鐘**
- 確保有足夠的 GPU 記憶體（建議 **8GB+**）
- 結果檔案可能會佔用磁碟空間（每個影片約 10-50 MB）
- 建議在實驗期間不要運行其他 GPU 密集型程式
- 使用 `quantized=False` 以獲得最佳品質（但需要更多記憶體）

## 預期結果

根據典型 GPU 性能（如 RTX 3080/4080）：

| 時長 | FPS | 總幀數 | 預期生成時間 |
|------|-----|--------|--------------|
| 5秒  | 16  | 80     | 2-4 分鐘     |
| 10秒 | 16  | 160    | 4-8 分鐘     |

**注意**：實際時間會因 GPU 型號、記憶體、提示詞複雜度而異。
